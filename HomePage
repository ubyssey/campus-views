<!DOCTYPE html>
<html>
<head>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script>
<script src="https://storage.googleapis.com/vrview/2.0/build/vrview.min.js"></script>

</head>
<body>

<div class="Home">
  <div id="OpenContent">
    Views of UBC
    Click to Explore
  </div>
</div>

<div class = "PicturePage">
  <div id="Pictures">
    Pictures go here
    <div id="vrview">
      <ul class="carousel">
        <li>
          <a href="#mosquitoFeild">
            <small>Mosquito Feild</small>
          </a>
        </li>
        <li>
          <a href="#marineDrive">
            <small>Marine Drive</small>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<script>
  $(document).ready(function(){

    console.log('ready');

      $("#Pictures").hide();
      $("#vrview").hide();
      $("#SwitchImage").hide();
      $("#OpenContent").click(function(){
          $(this).hide();
      });
      $("#OpenContent").on('click', function() {
        $("#Pictures").show();
        $("#vrview").show();
      })
  });
</script>

<script>
//Google VR API script to swap out photos
var vrView;
var browserHeight = $(window).height();
// All the scenes for the experience
var scenes = {
  marineDrive: {
    image: 'https://raw.githubusercontent.com/ubyssey/campus-views/master/VR_Photos/Marine_Drive.jpg',
  },
  mosquitoFeild: {
    image: 'https://raw.githubusercontent.com/ubyssey/campus-views/master/VR_Photos/Mosquito_Feild.jpg',
  },
};

function onLoad() {
  vrView = new VRView.Player('#vrview', {
    width: '100%',
    height: browserHeight,
    image: 'https://raw.githubusercontent.com/ubyssey/campus-views/master/VR_Photos/Marine_Drive.jpg',
    is_stereo: false,
    is_autopan_off: true
  });

  vrView.on('ready', onVRViewReady);
  vrView.on('modechange', onModeChange);
  vrView.on('error', onVRViewError);
}

function loadScene(id) {
  console.log('loadScene', id);

  // Set the image
  vrView.setContent({
    image: scenes[id].image,
    preview: scenes[id].preview,
    is_autopan_off: true
  });

  // Unhighlight carousel items
  var carouselLinks = document.querySelectorAll('ul.carousel li a');
  for (var i = 0; i < carouselLinks.length; i++) {
    carouselLinks[i].classList.remove('current');
  }

  // Highlight current carousel item
  document.querySelector('ul.carousel li a[href="#' + id + '"]')
      .classList.add('current');
}

function onVRViewReady(e) {
  console.log('onVRViewReady');

  // Create the carousel links
  var carouselItems = document.querySelectorAll('ul.carousel li a');
  for (var i = 0; i < carouselItems.length; i++) {
    var item = carouselItems[i];
    item.disabled = false;

    item.addEventListener('click', function(event) {
      event.preventDefault();
      loadScene(event.target.parentNode.getAttribute('href').substring(1));
    });
  }
  loadScene('marineDrive');
}

function onModeChange(e) {
  console.log('onModeChange', e.mode);
}

function onVRViewError(e) {
  console.log('Error! %s', e.message);
}

window.addEventListener('load', onLoad);
</script>

</body>
</html>
